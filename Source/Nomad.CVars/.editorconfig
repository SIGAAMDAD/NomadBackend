# ============================================================================
# The Nomad Framework - Editor Configuration
# STRICT ENFORCEMENT OF FORMATTING.md RULES
# ============================================================================

root = true

# ============================================================================
# GLOBAL SETTINGS
# ============================================================================

[*]
charset = utf-8
indent_style = tab
tab_width = 4
insert_final_newline = true
trim_trailing_whitespace = true
end_of_line = lf

# ============================================================================
# C# SPECIFIC RULES (STRICT ENFORCEMENT)
# ============================================================================

[*.cs]

# ==================== INDENTATION & BRACES ====================
indent_style = tab
tab_width = 4

# K&R Brace Style (Braces on same line)
csharp_new_line_before_open_brace = none
csharp_new_line_before_else = false
csharp_new_line_before_catch = false
csharp_new_line_before_finally = false
csharp_new_line_before_members_in_object_initializers = false

# Indentation settings
csharp_indent_block_contents = true
csharp_indent_braces = false
csharp_indent_case_contents = true
csharp_indent_case_contents_when_block = true
csharp_indent_labels = one_less_than_current
csharp_indent_switch_labels = true

# ==================== SPACING RULES ====================
# Space after parentheses in control statements
csharp_space_after_keywords_in_control_flow_statements = true

# Space after opening paren and before closing paren
csharp_space_between_method_call_name_and_opening_parenthesis = false
csharp_space_between_method_call_parameter_list_parentheses = true
csharp_space_between_method_declaration_name_and_opening_parenthesis = false
csharp_space_between_method_declaration_parameter_list_parentheses = true

# Collections and arrays with spaces after [ and before ]
csharp_space_before_open_square_brackets = false
csharp_space_between_empty_square_brackets = false
csharp_space_between_square_brackets = false

# Method parameters and calls
csharp_space_after_comma = true
csharp_space_before_comma = false

# Binary operators
csharp_space_around_binary_operators = before_and_after

# Casts
csharp_space_after_cast = false

# Colons
csharp_space_before_colon_in_inheritance_clause = true
csharp_space_after_colon_in_inheritance_clause = true

# ==================== NAMING CONVENTIONS ====================
# PascalCase for types, methods, properties, public fields
dotnet_naming_rule.types_should_be_pascal_case.severity = error
dotnet_naming_rule.types_should_be_pascal_case.symbols = types
dotnet_naming_rule.types_should_be_pascal_case.style = pascal_case

dotnet_naming_rule.methods_should_be_pascal_case.severity = error
dotnet_naming_rule.methods_should_be_pascal_case.symbols = methods
dotnet_naming_rule.methods_should_be_pascal_case.style = pascal_case

dotnet_naming_rule.properties_should_be_pascal_case.severity = error
dotnet_naming_rule.properties_should_be_pascal_case.symbols = properties
dotnet_naming_rule.properties_should_be_pascal_case.style = pascal_case

dotnet_naming_rule.public_fields_should_be_pascal_case.severity = error
dotnet_naming_rule.public_fields_should_be_pascal_case.symbols = public_fields
dotnet_naming_rule.public_fields_should_be_pascal_case.style = pascal_case

# camelCase for parameters and local variables
dotnet_naming_rule.parameters_should_be_camel_case.severity = error
dotnet_naming_rule.parameters_should_be_camel_case.symbols = parameters
dotnet_naming_rule.parameters_should_be_camel_case.style = camel_case

dotnet_naming_rule.locals_should_be_camel_case.severity = error
dotnet_naming_rule.locals_should_be_camel_case.symbols = locals
dotnet_naming_rule.locals_should_be_camel_case.style = camel_case

# SNAKE_CASE for constants
dotnet_naming_rule.constants_should_be_snake_case.severity = error
dotnet_naming_rule.constants_should_be_snake_case.symbols = constants
dotnet_naming_rule.constants_should_be_snake_case.style = snake_case

# Exception for static readonly StringName (Godot PascalCase)
dotnet_naming_rule.stringname_constants_should_be_pascal_case.severity = error
dotnet_naming_rule.stringname_constants_should_be_pascal_case.symbols = stringname_constants
dotnet_naming_rule.stringname_constants_should_be_pascal_case.style = pascal_case

# Symbol groups
dotnet_naming_symbols.types.applicable_kinds = class, struct, interface, enum, delegate
dotnet_naming_symbols.types.applicable_accessibilities = *

dotnet_naming_symbols.methods.applicable_kinds = method
dotnet_naming_symbols.methods.applicable_accessibilities = *

dotnet_naming_symbols.properties.applicable_kinds = property
dotnet_naming_symbols.properties.applicable_accessibilities = *

dotnet_naming_symbols.public_fields.applicable_kinds = field
dotnet_naming_symbols.public_fields.applicable_accessibilities = public

dotnet_naming_symbols.parameters.applicable_kinds = parameter
dotnet_naming_symbols.parameters.applicable_accessibilities = *

dotnet_naming_symbols.locals.applicable_kinds = local
dotnet_naming_symbols.locals.applicable_accessibilities = *

dotnet_naming_symbols.constants.applicable_kinds = field
dotnet_naming_symbols.constants.applicable_accessibilities = *
dotnet_naming_symbols.constants.required_modifiers = const

dotnet_naming_symbols.stringname_constants.applicable_kinds = field
dotnet_naming_symbols.stringname_constants.applicable_accessibilities = *
dotnet_naming_symbols.stringname_constants.required_modifiers = static, readonly
dotnet_naming_symbols.stringname_constants.descriptions = Static readonly StringName constants

# Naming styles
dotnet_naming_style.pascal_case.capitalization = pascal_case
dotnet_naming_style.camel_case.capitalization = camel_case
dotnet_naming_style.snake_case.capitalization = all_upper
dotnet_naming_style.snake_case.required_prefix = 
dotnet_naming_style.snake_case.required_suffix = 
dotnet_naming_style.snake_case.word_separator = _

# ==================== CODE QUALITY RULES ====================
# XML Documentation (REQUIRED for public APIs)
dotnet_diagnostic.CS1591.severity = error  # Missing XML comment for publicly visible type or member

# 'var' usage restrictions
dotnet_diagnostic.IDE0007.severity = warning  # 'var' preferences
csharp_style_var_elsewhere = false:error
csharp_style_var_for_built_in_types = false:error
csharp_style_var_when_type_is_apparent = true:suggestion

# Modern new() restrictions
dotnet_diagnostic.IDE0090.severity = suggestion  # Use 'new()' - only as suggestion

# Readonly when possible
dotnet_diagnostic.IDE0044.severity = suggestion  # Make field readonly

# Nameof operator preference
dotnet_diagnostic.IDE0049.severity = suggestion  # Use language keywords instead of framework type names for type references

# Exceptions in hot path
dotnet_diagnostic.CA2200.severity = warning  # Rethrow to preserve stack details

# Enum.IsDefined restriction
dotnet_diagnostic.CA2248.severity = error  # Provide correct 'enum' argument to 'Enum.HasFlag'

# foreach loop restrictions
dotnet_diagnostic.CA1829.severity = suggestion  # Use Length/Count property instead of Count() method
dotnet_diagnostic.CA1826.severity = warning  # Do not use Enumerable methods on indexable collections

# Thread safety
dotnet_diagnostic.CA2007.severity = suggestion  # Consider calling ConfigureAwait on the awaited task

# ==================== FORMATTING ENFORCEMENT ====================
# Switch statement formatting
csharp_new_line_before_switch_labels = true
csharp_new_line_before_switch_statements = false

# Property formatting
csharp_new_line_before_property_accessors = false

# Constructor formatting - OVERRIDE for base calls
# Note: We'll enforce via analyzer, but .editorconfig can't enforce specific constructor formatting
csharp_new_line_before_constructor_initializer = true
csharp_new_line_before_constructor_initializer_type = all

# Semicolon after class/namespace
csharp_new_line_before_type_declaration_curly_brace = false
csharp_new_line_before_namespace_curly_brace = false

# ==================== FILE HEADER ====================
# MPL 2.0 License Header
file_header_template = |
  /*
  ===========================================================================
  The Nomad Framework
  Copyright (C) {copyright_year} Noah Van Til

  This Source Code Form is subject to the terms of the Mozilla Public
  License, v. 2.0. If a copy of the MPL was not distributed with this
  file, You can obtain one at https://mozilla.org/MPL/2.0/.

  This software is provided "as is", without warranty of any kind,
  express or implied, including but not limited to the warranties
  of merchantability, fitness for a particular purpose and noninfringement.
  ===========================================================================
  */

# ==================== WARNING/ERROR SEVERITY ====================
# Critical formatting errors
dotnet_diagnostic.IDE0055.severity = error  # Fix formatting

# Important warnings
dotnet_diagnostic.IDE0040.severity = warning  # Add accessibility modifiers
dotnet_diagnostic.IDE0051.severity = warning  # Remove unused private members
dotnet_diagnostic.IDE0060.severity = warning  # Remove unused parameter

# ==================== CLASS LAYOUT ORDER ENFORCEMENT ====================
# Note: .editorconfig cannot enforce member ordering, but we can use a separate analyzer
# For now, we'll document the expected order in comments

# ============================================================================
# ADDITIONAL ANALYZER CONFIGURATION (Add to .csproj)
# ============================================================================
# To fully enforce FORMATTING.md rules, add these NuGet packages:
# - StyleCop.Analyzers (for ordering)
# - Microsoft.CodeAnalysis.NetAnalyzers (for additional rules)

# ============================================================================
# EXCLUSIONS AND WORKAROUNDS
# ============================================================================

# Godot-generated code
[*/GodotSharp/*.cs]
dotnet_diagnostic.CS1591.severity = none
dotnet_diagnostic.IDE0055.severity = none
csharp_new_line_before_open_brace = none

# Test projects (optional: less strict)
[*/Tests/*.cs]
dotnet_diagnostic.CS1591.severity = none
dotnet_diagnostic.IDE0055.severity = warning

# Generated code
[*/Generated/*.cs]
generated_code = true
dotnet_diagnostic.CS1591.severity = none
dotnet_diagnostic.IDE0055.severity = none

# ============================================================================
# OTHER FILE TYPES
# ============================================================================

[*.{json,yml,yaml}]
indent_style = space
indent_size = 2

[*.md]
trim_trailing_whitespace = false